<%= form_for(@child, html: { role: "form" }) do |f| %>
<%= error_messages(@child) %>

<div class="box box-primary">
  <div class="box-header with-border">
    <%= fa_icon "info" %>
    <h3 class="box-title">
      <%= t "children.new.details_title" %>
    </h3>
  </div>
  <div class="box-body">
    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <%= f.label :household_id %>
          <%= f.collection_select :household_id, Household.all, :id, :name,
            {include_blank: true}, class: "form-control" %>
        </div>
        <div class="form-group">
          <%= f.label :intake_date %>
          <div class="row date-select">
            <%= f.date_select :intake_date, { order: [:month, :day, :year]}, {class: "form-control"} %>
          </div>
        </div>
        <div class="form-group">
          <%= f.label :first_name, Child.human_attribute_name(:first_name) %>
          <%= f.text_field :first_name, class: "form-control" %>
        </div>
        <div class="form-group">
          <%= f.label :last_name, Child.human_attribute_name(:last_name) %>
          <%= f.text_field :last_name, class: "form-control" %>
        </div>
        <div class="form-group">
          <%= f.label :middle_name, Child.human_attribute_name(:middle_name) %>
          <%= f.text_field :middle_name, class: "form-control" %>
        </div>
        <div class="form-group">
          <%= f.label :sex, Child.human_attribute_name(:sex) %>
          <div class="checkbox">
            <% Child::SEX_OPTIONS.each do |sex_option| %>
            <label class="radio-inline">
              <%= f.radio_button :sex, sex_option[1], class: "square-red" %>
              <%= t(sex_option[0]) %>
            </label>
            <% end %>
          </div>
        </div>
        <div class="form-group">
          <%= f.label :age, Child.human_attribute_name(:age) %>
          <%= f.text_field :age, class: "form-control" %>
        </div>
      </div>
      <div class="col-md-offset-2 col-md-4">
        <div class="fileinput fileinput-new" data-provides="fileinput">
          <div class="fileinput-new thumbnail" style="width: 200px">
            <%=  preview_avatar(@child) %>
          </div>
          <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px"></div>
          <div>
            <span class="btn btn-default btn-file">
              <span class="fileinput-new"><%= t("children.new.select_image") %></span>
              <span class="fileinput-exists"><%= t("children.new.change") %></span>
              <%= f.file_field :avatar, accept: 'image/png,image/gif,image/jpeg,image/jpg', onchange: "validateFiles(this);", data: { max_file_size: 5.megabytes, max_file_size_message: t("children.new.select_image", size: 5.megabytes), file_format_message:
              t("children.new.image_format") } %>
            </span>
            <a href="#" class="btn btn-default fileinput-exists" data-dismiss="fileinput">
              <%= t("children.new.remove_image") %>
            </a>
          </div>
        </div>
      </div>
    </div>
    <%= render partial: 'custom_fields/custom_field', collection: @section_1_custom_fields %>
  </div>
</div>

<%= render partial: 'custom_sections/custom_section', collection: @sections %>

<% if params[:action] == "new" %>
  <div class="box box-primary">
    <div class="box-header with-border">
      <%= fa_icon "map-marker" %>
      <h3 class="box-title">
        <%= t "children.new.baseline_title" %>
      </h3>
    </div>
    <div class="box-body">
      <%= f.fields_for :statuses do |ff| %>
        <%= render partial: 'status_form', locals: {f: ff} %>
      <% end %>
    </div>
  </div>
<% end %>

<div class="form-group">
  <div class="col-sm-4 col-sm-offset-4">
    <%= link_to children_path, :class => 'btn btn-danger btn-block' do %>
    <i class="fa fa-times"></i>
    <%= t("general.cancel") %>
    <% end %>
  </div>
  <div class="col-sm-4">
    <button type="submit" class="btn btn-primary btn-block"><%= t("general.submit") %></button>
  </div>
</div>
<% end %>
